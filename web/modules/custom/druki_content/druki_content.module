<?php

/**
 * @file
 * Provides a druki content entity type.
 */

use Drupal\Core\Block\BlockPluginInterface;
use Drupal\Core\Form\FormStateInterface;

/**
 * Implements hook_theme().
 */
function druki_content_theme(): array {
  return [
    'druki_content' => [
      'render element' => 'elements',
      'file' => 'druki_content.theme.inc',
    ],
    'druki_content_edit_form' => [
      'render element' => 'form',
    ],
    'druki_content_toc' => [
      'variables' => [
        'druki_content' => NULL,
      ],
      'file' => 'druki_content.theme.inc',
    ],
    'druki_content_category_navigation' => [
      'variables' => [
        'links' => [],
      ],
      'file' => 'druki_content.theme.inc',
    ],
    'druki_content_help_and_feedback' => [
      'variables' => [
        'edit_url' => NULL,
        'improve_url' => NULL,
      ],
    ],
  ];
}

/**
 * Implements hook_form_FORM_ID_alter().
 */
function druki_content_form_block_form_alter(array &$form, FormStateInterface $form_state, string $form_id): void {
  // @see https://www.drupal.org/node/2284687
  unset($form['visibility']['druki_content']);
}

/**
 * Implements hook_block_view_BASE_BLOCK_ID_alter().
 */
function druki_content_block_view_druki_category_navigation_alter(array &$build, BlockPluginInterface $block) {
  $build['#configuration']['label'] = $block->label();
}
